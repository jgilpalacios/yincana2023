<?php
$MisPrimos=array(
'0' => '83074430407246804977948661034316574916577030266284368624005397095990286985739',
'1' => '79241848729658822335719453532128157498066879169043821950329097214285812225367',
'2' => '83128839605654320634484590082006555528460318756676849391749800786405719427163',
'3' => '104011471890122364370340808816319243750686057212280429786004308658142517485843',
'4' => '98725026820836007781788628885688153237073370220501260030163883900149077026199',
'5' => '81673424773647879536984153228430788020797806382398321370372561229099208100347',
'6' => '104397640813684759020816969279761693917657535631495118457825495480286854532527',
'7' => '96378646831941803843428782683763748002320480076797614327204269376827309291263',
'8' => '58948485017428351615181423450120442470028367834126477127024951933346526887587',
'9' => '111850808194414464915969829541560283303131255890611118365908132935671275440203',
'10' => '59082848947592387879955228142782375294682810385176223897508073219432378589399',
'11' => '102347531001765281428902814892127456014519787843270225314105991907551998966579',
'12' => '74519282843158671507086610986330913580694282805281267822269741993688563337087',
'13' => '58284848578666317941358171811261604287123011173823547766275143612022686614807',
'14' => '67378485185103554184556786491684068823013682268507158750918918778176976871163',
'15' => '60114506491555595618506101257608508619173879641028728551226559292274997544923',
'16' => '108594022858012783572023256700536019882700938488178696958464861495494587673947',
'17' => '110927251340551644429396643018799033103697135627148260617468183671312699254259',
'18' => '84990173806279791709551303162852772469247942268689912571477973317730043323303',
'19' => '70696212627570023784644338846905207574957888952268103070955754641653563351307');
/**
 * Función que devuelve uno de los primos de la tabla, son primos y (n-1)/2 también es primo
 */
function GetPrimo($MisPrimos){
	//return '83074430407246804977948661034316574916577030266284368624005397095990286985739';
	return $MisPrimos[mt_rand (0,19)];

}

/*para sustituir bcdpowmod en versiones anteriores a php5
 
function powmod($m,$e,$n) {
    if (intval(PHP_VERSION)>4) {
        return(bcpowmod($m,$e,$n));
    } else {
        $r="";
        while ($e!="0") {
            $t=bcmod($e,"4096");
            $r=substr("000000000000".decbin(intval($t)),-12).$r;
            $e=bcdiv($e,"4096");
        }
        $r=preg_replace("!^0+!","",$r);
        if ($r=="") $r="0";
        $m=bcmod($m,$n);
        $erb=strrev($r);
        $q="1";
        $a[0]=$m;
        for ($i=1;$i<strlen($erb);$i++) {
            $a[$i]=bcmod(bcmul($a[$i-1],$a[$i-1]),$n);
        }
        for ($i=0;$i<strlen($erb);$i++) {
            if ($erb[$i]=="1") {
                $q=bcmod(bcmul($q,$a[$i]),$n);
            }
        }
        return($q);
    }
}*/
?>
